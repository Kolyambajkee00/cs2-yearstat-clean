# Техническое задание на проект: CS2 Stats Tracker

## 1. Цель проекта
Разработка веб-сервиса для отслеживания и анализа статистики Counter-Strike 2. Система позволяет игрокам мониторить свой прогресс, анализировать игровые показатели (K/D ratio, win rate) и визуализировать динамику производительности через интерактивные графики. Сервис решает проблему отсутствия удобного инструмента для долгосрочного анализа CS2 статистики с интеграцией данных из Steam.

## 2. Роли пользователей
- **Гость**: Поиск игроков по Steam ID, просмотр базовой статистики и графиков, доступ к общедоступной аналитике.
- **Администратор**: Полный доступ к админ-панели Django для управления данными, пользователями и мониторинга работы системы.

## 3. Модели данных
**Player (Игрок)**:
- `steam_id`: Уникальный идентификатор Steam (CharField, 20 символов)
- `nickname`: Никнейм игрока (CharField, 100 символов)
- `avatar`: Ссылка на аватар (URLField)
- `country`: Код страны (CharField, 10 символов)
- `cs2_hours`: Количество часов в CS2 (FloatField)
- `last_updated`: Дата последнего обновления (DateTimeField)

**MonthlyStat (Месячная статистика)**:
- `player`: Связь с моделью Player (ForeignKey)
- `year`: Год статистики (IntegerField)
- `month`: Месяц статистики (IntegerField, выбор из 12 месяцев)
- `matches_played`: Количество сыгранных матчей (IntegerField)
- `kills`: Количество убийств (IntegerField)
- `deaths`: Количество смертей (IntegerField)
- `wins`: Количество побед (IntegerField)
- `kd_ratio`: Соотношение убийств к смертям (свойство, вычисляемое)
- `win_rate`: Процент побед (свойство, вычисляемое)

**StatisticCalculations (Расчеты статистики)** - неявная модель:
- Автоматический расчет K/D ratio: `kills / deaths`
- Автоматический расчет win rate: `(wins / matches_played) * 100%`
- Агрегация данных для графиков и сводной статистики

## 4. Ключевой функционал (User Stories)
* **Поиск игрока**: Пользователь вводит Steam ID на главной странице, система получает данные из Steam API (аватар, никнейм, часы в игре) и отображает профиль игрока.
* **Добавление месячной статистики**: Пользователь заполняет форму с игровыми показателями за конкретный месяц, система автоматически рассчитывает K/D ratio и win rate, сохраняет данные и обновляет общую статистику игрока.
* **Визуализация прогресса**: Система строит интерактивные графики (Plotly) динамики K/D ratio и win rate по месяцам, позволяя игроку анализировать свой прогресс и выявлять тренды.
* **Сравнительный анализ**: Пользователь может просматривать сводную статистику (общее количество матчей, средний K/D, общий win rate) и сравнивать показатели между разными месяцами.
* **Управление данными**: Администратор может редактировать и удалять статистические записи через Django Admin, а также обновлять данные игроков из Steam API.

## 5. Внешние интеграции / Аналитика

### Внешние интеграции:
- **Steam Web API**: Автоматическое получение данных об игроках (Steam ID, никнейм, аватар, страна, количество часов в CS2) через официальный API Valve.
- **Интеграционные конечные точки**: 
  - `ISteamUser/GetPlayerSummaries/v0002/` - информация профиля игрока
  - `IPlayerService/GetOwnedGames/v0001/` - время в играх

### Аналитика и обработка данных:
- **Pandas**: Библиотека для анализа и агрегации статистических данных, расчет средних показателей, подготовка данных для визуализации.
- **Plotly**: Создание интерактивных графиков и диаграмм для визуализации динамики игровых показателей.
- **NumPy**: Математические вычисления для статистического анализа.

## 6. Изменения в ходе реализации
1. **Расширение функционала аналитики**: В процессе разработки добавлена возможность построения не только линейных графиков, но и столбчатых диаграмм для сравнения показателей между месяцами.
2. **Улучшение UX**: Добавлены информационные карточки с подсказками о том, какие данные будут рассчитаны автоматически при вводе статистики.
3. **Оптимизация работы с Steam API**: Реализовано кэширование данных игроков для уменьшения количества запросов к внешнему API.
4. **Адаптация под PythonAnywhere**: Настройка проекта для работы на бесплатном хостинге с учетом ограничений по версиям Python и библиотек.

## 7. Технический стек
- **Backend**: Python 3.12, Django 6.0
- **Database**: SQLite (разработка), SQLite (продакшн на PythonAnywhere)
- **Frontend**: HTML5, CSS3, Bootstrap 5.3, JavaScript
- **Визуализация**: Plotly.js, Chart.js
- **API интеграции**: Steam Web API, requests библиотека
- **Аналитика**: Pandas, NumPy
- **Хостинг**: PythonAnywhere (бесплатный тариф)
- **Контроль версий**: Git, GitHub